import type { FontProfile, FontCategory } from './types';

const CATEGORY_FALLBACKS: Record<FontCategory, Omit<FontProfile, 'family'>> = {
  'sans-serif': {
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.0,
    displayTightening: -0.02,
    uppercaseBoost: 0.05,
    weights: {},
  },
  'serif': {
    category: 'serif',
    baseLineHeightRatio: 1.35,
    baseTrackingRatio: 0.005,
    displayTightening: -0.015,
    uppercaseBoost: 0.06,
    weights: {},
  },
  'mono': {
    category: 'mono',
    baseLineHeightRatio: 1.5,
    baseTrackingRatio: 0.0,
    displayTightening: -0.01,
    uppercaseBoost: 0.04,
    weights: {},
  },
  'display': {
    category: 'display',
    baseLineHeightRatio: 1.2,
    baseTrackingRatio: -0.01,
    displayTightening: -0.03,
    uppercaseBoost: 0.07,
    weights: {},
  },
};

// Tier 1: 30 fonts with hand-tuned profiles
const FONT_PROFILES: FontProfile[] = [
  // --- Google Fonts top 20 ---
  {
    family: 'Inter',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.0,
    displayTightening: -0.022,
    uppercaseBoost: 0.05,
    weights: {
      100: { lineHeightAdjust: 0.03, trackingAdjust: 0.005 },
      300: { lineHeightAdjust: 0.02, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.002 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.004 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.005 },
      800: { lineHeightAdjust: -0.025, trackingAdjust: -0.007 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.008 },
    },
  },
  {
    family: 'Roboto',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.005,
    displayTightening: -0.02,
    uppercaseBoost: 0.05,
    weights: {
      100: { lineHeightAdjust: 0.03, trackingAdjust: 0.005 },
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.002 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.005 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.008 },
    },
  },
  {
    family: 'Open Sans',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.003,
    displayTightening: -0.018,
    uppercaseBoost: 0.05,
    weights: {
      300: { lineHeightAdjust: 0.02, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.003 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.005 },
      800: { lineHeightAdjust: -0.025, trackingAdjust: -0.007 },
    },
  },
  {
    family: 'Montserrat',
    category: 'sans-serif',
    baseLineHeightRatio: 1.35,
    baseTrackingRatio: -0.005,
    displayTightening: -0.025,
    uppercaseBoost: 0.06,
    weights: {
      100: { lineHeightAdjust: 0.03, trackingAdjust: 0.008 },
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.004 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.002 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.004 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.006 },
      800: { lineHeightAdjust: -0.025, trackingAdjust: -0.008 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.01 },
    },
  },
  {
    family: 'Lato',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.003,
    displayTightening: -0.018,
    uppercaseBoost: 0.05,
    weights: {
      100: { lineHeightAdjust: 0.03, trackingAdjust: 0.005 },
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.005 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.008 },
    },
  },
  {
    family: 'Poppins',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.005,
    displayTightening: -0.02,
    uppercaseBoost: 0.05,
    weights: {
      100: { lineHeightAdjust: 0.03, trackingAdjust: 0.006 },
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.002 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.004 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.005 },
      800: { lineHeightAdjust: -0.025, trackingAdjust: -0.007 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.009 },
    },
  },
  {
    family: 'Noto Sans',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.002,
    displayTightening: -0.018,
    uppercaseBoost: 0.05,
    weights: {
      100: { lineHeightAdjust: 0.03, trackingAdjust: 0.005 },
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.002 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.005 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.008 },
    },
  },
  {
    family: 'Raleway',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.008,
    displayTightening: -0.025,
    uppercaseBoost: 0.06,
    weights: {
      100: { lineHeightAdjust: 0.03, trackingAdjust: 0.006 },
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.004 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.006 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.009 },
    },
  },
  {
    family: 'Ubuntu',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.004,
    displayTightening: -0.018,
    uppercaseBoost: 0.05,
    weights: {
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.002 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.005 },
    },
  },
  {
    family: 'Nunito',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.003,
    displayTightening: -0.02,
    uppercaseBoost: 0.05,
    weights: {
      200: { lineHeightAdjust: 0.025, trackingAdjust: 0.005 },
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.003 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.005 },
      800: { lineHeightAdjust: -0.025, trackingAdjust: -0.007 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.009 },
    },
  },
  {
    family: 'Playfair Display',
    category: 'serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: -0.005,
    displayTightening: -0.025,
    uppercaseBoost: 0.07,
    weights: {
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.002 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.004 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.006 },
      800: { lineHeightAdjust: -0.025, trackingAdjust: -0.008 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.01 },
    },
  },
  {
    family: 'PT Sans',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.004,
    displayTightening: -0.018,
    uppercaseBoost: 0.05,
    weights: {
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.005 },
    },
  },
  {
    family: 'Merriweather',
    category: 'serif',
    baseLineHeightRatio: 1.45,
    baseTrackingRatio: 0.005,
    displayTightening: -0.015,
    uppercaseBoost: 0.06,
    weights: {
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.005 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.008 },
    },
  },
  {
    family: 'Rubik',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.002,
    displayTightening: -0.02,
    uppercaseBoost: 0.05,
    weights: {
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.002 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.003 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.005 },
      800: { lineHeightAdjust: -0.025, trackingAdjust: -0.007 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.009 },
    },
  },
  {
    family: 'Work Sans',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.003,
    displayTightening: -0.02,
    uppercaseBoost: 0.05,
    weights: {
      100: { lineHeightAdjust: 0.03, trackingAdjust: 0.006 },
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.002 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.004 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.006 },
      800: { lineHeightAdjust: -0.025, trackingAdjust: -0.008 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.01 },
    },
  },
  {
    family: 'DM Sans',
    category: 'sans-serif',
    baseLineHeightRatio: 1.35,
    baseTrackingRatio: -0.003,
    displayTightening: -0.022,
    uppercaseBoost: 0.05,
    weights: {
      100: { lineHeightAdjust: 0.03, trackingAdjust: 0.006 },
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.002 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.005 },
    },
  },
  {
    family: 'Manrope',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.002,
    displayTightening: -0.02,
    uppercaseBoost: 0.05,
    weights: {
      200: { lineHeightAdjust: 0.025, trackingAdjust: 0.005 },
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.002 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.004 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.006 },
      800: { lineHeightAdjust: -0.025, trackingAdjust: -0.008 },
    },
  },
  {
    family: 'Space Grotesk',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: -0.01,
    displayTightening: -0.03,
    uppercaseBoost: 0.06,
    weights: {
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.005 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.003 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.005 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.007 },
    },
  },
  {
    family: 'IBM Plex Sans',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.004,
    displayTightening: -0.018,
    uppercaseBoost: 0.05,
    weights: {
      100: { lineHeightAdjust: 0.03, trackingAdjust: 0.005 },
      200: { lineHeightAdjust: 0.025, trackingAdjust: 0.004 },
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.002 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.004 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.005 },
    },
  },
  {
    family: 'Jost',
    category: 'sans-serif',
    baseLineHeightRatio: 1.35,
    baseTrackingRatio: 0.0,
    displayTightening: -0.022,
    uppercaseBoost: 0.06,
    weights: {
      100: { lineHeightAdjust: 0.03, trackingAdjust: 0.006 },
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.002 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.004 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.006 },
      800: { lineHeightAdjust: -0.025, trackingAdjust: -0.008 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.01 },
    },
  },
  // --- Popular commercial fonts ---
  {
    family: 'SF Pro',
    category: 'sans-serif',
    baseLineHeightRatio: 1.37,
    baseTrackingRatio: 0.0,
    displayTightening: -0.025,
    uppercaseBoost: 0.05,
    weights: {
      100: { lineHeightAdjust: 0.03, trackingAdjust: 0.006 },
      200: { lineHeightAdjust: 0.025, trackingAdjust: 0.005 },
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.008, trackingAdjust: -0.002 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.004 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.006 },
      800: { lineHeightAdjust: -0.025, trackingAdjust: -0.008 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.01 },
    },
  },
  {
    family: 'PP Neue Montreal',
    category: 'sans-serif',
    baseLineHeightRatio: 1.35,
    baseTrackingRatio: -0.005,
    displayTightening: -0.025,
    uppercaseBoost: 0.06,
    weights: {
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.003 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.006 },
    },
  },
  {
    family: 'Golos',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.003,
    displayTightening: -0.02,
    uppercaseBoost: 0.05,
    weights: {
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.002 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.004 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.005 },
    },
  },
  {
    family: 'Graphik',
    category: 'sans-serif',
    baseLineHeightRatio: 1.35,
    baseTrackingRatio: 0.002,
    displayTightening: -0.025,
    uppercaseBoost: 0.06,
    weights: {
      100: { lineHeightAdjust: 0.03, trackingAdjust: 0.006 },
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.003 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.005 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.007 },
    },
  },
  {
    family: 'Gilroy',
    category: 'sans-serif',
    baseLineHeightRatio: 1.35,
    baseTrackingRatio: 0.0,
    displayTightening: -0.025,
    uppercaseBoost: 0.06,
    weights: {
      100: { lineHeightAdjust: 0.03, trackingAdjust: 0.006 },
      200: { lineHeightAdjust: 0.025, trackingAdjust: 0.005 },
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.002 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.004 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.006 },
      800: { lineHeightAdjust: -0.025, trackingAdjust: -0.008 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.01 },
    },
  },
  {
    family: 'TT Norms Pro',
    category: 'sans-serif',
    baseLineHeightRatio: 1.35,
    baseTrackingRatio: 0.002,
    displayTightening: -0.022,
    uppercaseBoost: 0.05,
    weights: {
      100: { lineHeightAdjust: 0.03, trackingAdjust: 0.006 },
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.002 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.006 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.01 },
    },
  },
  {
    family: 'Basis Grotesque',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.005,
    displayTightening: -0.02,
    uppercaseBoost: 0.05,
    weights: {
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.003 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.006 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.009 },
    },
  },
  {
    family: 'Suisse Int\'l',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.003,
    displayTightening: -0.022,
    uppercaseBoost: 0.05,
    weights: {
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.003 },
      600: { lineHeightAdjust: -0.015, trackingAdjust: -0.005 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.007 },
    },
  },
  {
    family: 'Druk',
    category: 'display',
    baseLineHeightRatio: 1.15,
    baseTrackingRatio: -0.015,
    displayTightening: -0.04,
    uppercaseBoost: 0.08,
    weights: {
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      500: { lineHeightAdjust: -0.01, trackingAdjust: -0.003 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.006 },
      900: { lineHeightAdjust: -0.03, trackingAdjust: -0.01 },
    },
  },
  {
    family: 'Helios',
    category: 'sans-serif',
    baseLineHeightRatio: 1.4,
    baseTrackingRatio: 0.004,
    displayTightening: -0.018,
    uppercaseBoost: 0.05,
    weights: {
      300: { lineHeightAdjust: 0.015, trackingAdjust: 0.003 },
      400: { lineHeightAdjust: 0.0, trackingAdjust: 0.0 },
      700: { lineHeightAdjust: -0.02, trackingAdjust: -0.005 },
    },
  },
];

// Font aliases: map variant names to canonical profile
const FAMILY_ALIASES: Record<string, string> = {
  'sf pro display': 'sf pro',
  'sf pro text': 'sf pro',
  'sf pro rounded': 'sf pro',
  'roboto flex': 'roboto',
  'roboto slab': 'roboto',
  'roboto condensed': 'roboto',
  'noto sans jp': 'noto sans',
  'noto sans kr': 'noto sans',
  'noto sans sc': 'noto sans',
  'noto sans tc': 'noto sans',
  'noto serif': 'noto sans',
  'ibm plex mono': 'ibm plex sans',
  'ibm plex serif': 'ibm plex sans',
  'dm serif display': 'dm sans',
  'dm serif text': 'dm sans',
  'pt serif': 'pt sans',
  'space mono': 'space grotesk',
};

const profileMap = new Map<string, FontProfile>();
for (const p of FONT_PROFILES) {
  profileMap.set(p.family.toLowerCase(), p);
}

export function getProfile(family: string): FontProfile | null {
  const key = family.toLowerCase();
  return profileMap.get(key) ?? profileMap.get(FAMILY_ALIASES[key] || '') ?? null;
}

export function getFallbackProfile(category: FontCategory): FontProfile {
  const fallback = CATEGORY_FALLBACKS[category];
  return { family: '__fallback__', ...fallback };
}

export function getProfileOrFallback(family: string, category?: FontCategory): { profile: FontProfile; isApproximate: boolean } {
  const exact = getProfile(family);
  if (exact) return { profile: exact, isApproximate: false };
  return { profile: getFallbackProfile(category ?? 'sans-serif'), isApproximate: true };
}

export function guessCategory(styleName: string): FontCategory {
  const s = styleName.toLowerCase();
  if (s.includes('mono') || s.includes('code')) return 'mono';
  if (s.includes('serif') && !s.includes('sans')) return 'serif';
  if (s.includes('display') || s.includes('poster') || s.includes('headline')) return 'display';
  return 'sans-serif';
}

export const allFontFamilies = FONT_PROFILES.map(p => p.family);
